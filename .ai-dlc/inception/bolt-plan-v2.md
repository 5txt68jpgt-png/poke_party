# Bolt計画: ダブルバトル専用モード

## Unit構成

### Unit 1: タブUI・モード管理
**対応ストーリー**: US-1, US-2

モード切り替えのタブUIと、ダブルモード用のポケモン数選択を実装。

| Bolt | 内容 | 成果物 |
|------|------|--------|
| 1-1 | タブコンポーネント作成 | `BattleModeTab` コンポーネント |
| 1-2 | モード状態管理 | `PartyGenerator` にモード状態追加 |
| 1-3 | ポケモン数選択の分岐 | ダブル時は4/6匹選択に変更 |
| 1-4 | デプロイ・動作確認 | タブ切り替えが動作 |

---

### Unit 2: ダブル用AIプロンプト
**対応ストーリー**: US-3, US-4, US-5

ダブルバトル向けの技構成・戦術を考慮したAIプロンプトを実装。

| Bolt | 内容 | 成果物 |
|------|------|--------|
| 2-1 | ダブル用プロンプト設計 | `DOUBLE_SYSTEM_PROMPT` 定義 |
| 2-2 | API にモードパラメータ追加 | APIがモードを受け取り分岐 |
| 2-3 | おまかせ生成のダブル対応 | `DOUBLE_RANDOM_PROMPT` 定義 |
| 2-4 | デプロイ・生成テスト | ダブル向けパーティが生成される |

---

### Unit 3: 味方巻き込み技の注意表示
**対応ストーリー**: US-6

味方に当たる技に注意マークを表示し、説明を追加。

| Bolt | 内容 | 成果物 |
|------|------|--------|
| 3-1 | 味方巻き込み技データ作成 | `ally-hitting-moves.ts` |
| 3-2 | 技リストに注意マーク追加 | `MoveList` に警告アイコン |
| 3-3 | 説明ツールチップ実装 | タップで説明表示 |
| 3-4 | デプロイ・動作確認 | 注意表示が機能 |

---

### Unit 4: 統合・仕上げ
**対応ストーリー**: US-7, US-8

既存機能との統合確認とUI調整。

| Bolt | 内容 | 成果物 |
|------|------|--------|
| 4-1 | 既存機能のダブル対応確認 | 相性チェック・技入れ替えが動作 |
| 4-2 | パーティ表示にモード表示追加 | 「ダブル」バッジ表示 |
| 4-3 | UI調整・レスポンシブ確認 | スマホで使いやすいUI |
| 4-4 | 最終デプロイ・リリース | 本番公開 |

---

## 全体スケジュール

```
Unit 1: タブUI・モード管理
  └─ Bolt 1-1 → 1-2 → 1-3 → 1-4

Unit 2: ダブル用AIプロンプト
  └─ Bolt 2-1 → 2-2 → 2-3 → 2-4

Unit 3: 味方巻き込み技の注意表示
  └─ Bolt 3-1 → 3-2 → 3-3 → 3-4

Unit 4: 統合・仕上げ
  └─ Bolt 4-1 → 4-2 → 4-3 → 4-4
```

---

## 依存関係

- Unit 2 は Unit 1 完了後に着手（モード状態が必要）
- Unit 3 は Unit 1, 2 と並行可能
- Unit 4 は全Unit完了後

---

## リスク対応マッピング

| リスク | 対応Unit/Bolt |
|--------|---------------|
| R-1: AI技選定 | Unit 2 (Bolt 2-1, 2-3) |
| R-2: 巻き込み技判定 | Unit 3 (Bolt 3-1) |
| R-5: 既存機能影響 | Unit 4 (Bolt 4-1) |
