# Bolt Plan v3 - ポケモン検索機能

## 概要

v3の機能を1つのUnitで実装する。
主な作業はポケモン名データの準備と検索UIの実装。

---

## Unit 構成

```
Unit 6: ポケモン検索機能
```

---

## Unit 6: ポケモン検索機能

### 目的
相性チェック時にポケモン名で検索してタイプを自動選択できるようにする

### 対応ストーリー
- US-V3-1（ポケモン名で検索）
- US-V3-2（検索結果からタイプ自動選択）
- US-V3-3（タイプ直接選択との併用）
- US-V3-4（検索候補の視認性）

### 成果物
- ポケモン名データ（JSON）
- 検索ロジック
- 検索UI（インクリメンタルサーチ）
- モーダルUI更新

### Bolt（実装タスク）

| Bolt | タスク | 詳細 |
|------|--------|------|
| 6-1 | データ準備 | 全ポケモンの日本語名・英語名・タイプをJSON化 |
| 6-2 | 検索ロジック | 日本語名での部分一致検索関数 |
| 6-3 | 検索UI | インクリメンタルサーチコンポーネント |
| 6-4 | モーダル更新 | 相性チェックモーダルに検索UIを統合 |
| 6-5 | テスト | 検索精度・パフォーマンステスト |
| 6-6 | デプロイ | 本番環境へデプロイ |

### 完了条件
- [ ] ポケモン名を入力すると候補がリアルタイム表示される
- [ ] 候補を選択するとタイプが自動選択される
- [ ] 既存のタイプ直接選択も動作する
- [ ] 全世代のポケモンが検索可能
- [ ] 本番環境にデプロイ済み

---

## 技術詳細

### データ準備方針

**オプション1: PokeAPIから事前生成**
- ビルドスクリプトでPokeAPIから全ポケモンデータを取得
- 日本語名・英語名・タイプのみ抽出してJSON化
- メリット: 最新データを取得可能
- デメリット: ビルド時間増加、API制限

**オプション2: 静的データファイル**
- 事前に作成したJSONファイルをリポジトリに含める
- メリット: ビルド高速、API不要
- デメリット: 手動更新が必要

→ **オプション2を採用**（シンプルで高速）

### データ構造

```typescript
interface PokemonEntry {
  id: number;
  name: string;           // 英語名（API識別子）
  japaneseName: string;   // 日本語名
  types: PokemonTypeName[]; // タイプ（1〜2つ）
}

// pokemon-list.json
const pokemonList: PokemonEntry[] = [
  { id: 1, name: "bulbasaur", japaneseName: "フシギダネ", types: ["grass", "poison"] },
  { id: 25, name: "pikachu", japaneseName: "ピカチュウ", types: ["electric"] },
  // ...
];
```

### 検索ロジック

```typescript
function searchPokemon(query: string, limit: number = 8): PokemonEntry[] {
  const normalizedQuery = query.toLowerCase().trim();

  return pokemonList
    .filter(p => p.japaneseName.includes(normalizedQuery))
    .slice(0, limit);
}
```

### UI設計

```
┌─────────────────────────────────────┐
│ 技の相性チェック              ✕    │
├─────────────────────────────────────┤
│ [技の情報]                          │
│                                     │
│ 相手のポケモンを検索                 │
│ ┌─────────────────────────────────┐ │
│ │ ピカ                            │ │
│ └─────────────────────────────────┘ │
│ ┌─────────────────────────────────┐ │
│ │ ピカチュウ    [でんき]           │ │
│ │ ピカブイ      [でんき]           │ │
│ └─────────────────────────────────┘ │
│                                     │
│ または、タイプを直接選択             │
│ [タイプセレクター（既存）]           │
│                                     │
│ [相性結果]                          │
└─────────────────────────────────────┘
```

---

## リスク

| リスク | 影響 | 対策 |
|--------|------|------|
| データサイズが大きすぎる | 中 | 必要最小限のフィールドのみ含める |
| 検索が遅い | 中 | クライアントサイドでの効率的なフィルタリング |
| 日本語名の表記揺れ | 低 | 正規化処理を追加 |

---

## 見積もり

| Bolt | 作業量 |
|------|--------|
| 6-1 | 中（データ準備が最も時間がかかる） |
| 6-2 | 小 |
| 6-3 | 小 |
| 6-4 | 小 |
| 6-5 | 小 |
| 6-6 | 小 |
| **合計** | **中** |
