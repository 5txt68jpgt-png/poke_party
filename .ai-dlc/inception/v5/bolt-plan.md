# Bolt Plan v5 - バトルテンポ改善

## 概要

v5の機能を2つのUnitで実装する。
- Unit 9: 相手ポケモン選択保持
- Unit 10: 受けた技の相性チェック

---

## Unit 構成

```
Unit 9: 相手ポケモン選択保持
Unit 10: 受けた技の相性チェック
```

---

## Unit 9: 相手ポケモン選択保持

### 目的
相手ポケモンの選択状態をパーティレベルで保持し、技ごとの再検索を不要にする

### 対応ストーリー
- US-V5-1（相手ポケモンの選択保持）

### 成果物
- 状態管理の更新（PartyDisplayで相手ポケモンを保持）
- モーダルへの状態受け渡し

### Bolt（実装タスク）

| Bolt | タスク | 詳細 |
|------|--------|------|
| 9-1 | 状態管理 | PartyDisplayで相手ポケモンを保持 |
| 9-2 | モーダル更新 | 保持された相手ポケモンを初期表示 |
| 9-3 | テスト・デプロイ | 動作確認、本番デプロイ |

### 完了条件
- [ ] 相手ポケモン選択が保持される
- [ ] 別の技を開いても相手が維持される
- [ ] 本番環境にデプロイ済み

---

## Unit 10: 受けた技の相性チェック

### 目的
自分のポケモンが受けた技の相性をチェックできるようにする

### 対応ストーリー
- US-V5-2（受けた技の相性チェック）
- US-V5-3（技名で検索）
- US-V5-4（相性結果の視認性）

### 成果物
- 技データ（JSON）
- 技検索ロジック
- 技検索UI
- 受けた技チェックモーダル
- ポケモンカードにボタン追加

### Bolt（実装タスク）

| Bolt | タスク | 詳細 |
|------|--------|------|
| 10-1 | 技データ準備 | PokeAPIから全技の日本語名・タイプをJSON化 |
| 10-2 | 技検索ロジック | 日本語名での部分一致検索関数 |
| 10-3 | 技検索UI | インクリメンタルサーチコンポーネント |
| 10-4 | 受けた技モーダル | 相性チェック結果表示 |
| 10-5 | カード更新 | ポケモンカードにボタン追加 |
| 10-6 | テスト・デプロイ | 動作確認、本番デプロイ |

### 完了条件
- [ ] 技名を入力すると候補がリアルタイム表示される
- [ ] 技を選択すると自分への相性が表示される
- [ ] 全世代の技が検索可能
- [ ] 本番環境にデプロイ済み

---

## 技術詳細

### 技データ構造

```typescript
interface MoveEntry {
  id: number;
  name: string;           // 英語名（API識別子）
  japaneseName: string;   // 日本語名
  type: PokemonTypeName;  // タイプ
}

// move-list.json
const moveList: MoveEntry[] = [
  { id: 1, name: "pound", japaneseName: "はたく", type: "normal" },
  { id: 85, name: "thunderbolt", japaneseName: "10まんボルト", type: "electric" },
  // ...
];
```

### 状態保持の実装方針

```typescript
// PartyDisplay内で相手ポケモンを管理
const [opponentPokemon, setOpponentPokemon] = useState<PokemonEntry | null>(null);

// MoveEffectivenessModalに渡す
<MoveEffectivenessModal
  opponentPokemon={opponentPokemon}
  onOpponentChange={setOpponentPokemon}
  ...
/>
```

---

## リスク

| リスク | 影響 | 対策 |
|--------|------|------|
| 技データが大きすぎる | 中 | 必要最小限のフィールドのみ含める |
| 技名の表記揺れ | 低 | 正規化処理を追加 |
| 状態管理が複雑化 | 中 | シンプルなprops受け渡しで実装 |

---

## 見積もり

| Unit | 作業量 |
|------|--------|
| Unit 9 | 小 |
| Unit 10 | 中（技データ準備が最も時間がかかる） |
| **合計** | **中** |
